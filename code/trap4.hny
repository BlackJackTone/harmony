import synch;

def handler():
    count += 1;
    done = True;
;
def main():
    trap handler();
    setintlevel(True);
      count += 1;
    setintlevel(False);
    await done;
    assert count == 2;
;
mutex = Lock();
count = 0;
done = False;
spawn main();
