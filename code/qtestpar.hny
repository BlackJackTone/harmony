import queue

const NOPS = 4

q = queue.Queue()

def thread(self):
    if choose({ "get", "put" }) == "put":
        print("call put", self)
        queue.put(?q, self)
        print("done put", self)
    else:
        print("call get", self)
        let v = queue.get(?q):
            print("done get", self, v)

for i in {1..NOPS}:
    spawn thread(i)
