from synch import Lock, acquire, release;

count = 0;
countlock = Lock();
done = [ False, False ];

def process(self):
    acquire(?countlock);
    count = count + 1;
    release(?countlock);
    done[self] = True;
;
def main(self):
    await all(done);
    assert count == 2, count;
;

spawn process(0);
spawn process(1);
spawn main();
