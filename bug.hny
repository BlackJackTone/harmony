from synch import *

sequential w

thelock = Lock()
thecond = Condition()
x = False

def f():
    acquire(?thelock)
    wait(?thecond, ?thelock)
    release(?thelock)
    x = True

def g():
    acquire(?thelock)
    notify(?thecond)
    release(?thelock)

spawn eternal f()
spawn g()

finally x
