routine p():
    while True:
        while tas&(mylock): end while
        @cs: // critical section
        mylock := False;
    end while
end routine

mylock := False;
spawn p, 0;
spawn p, 1;
spawn p, 2;
spawn p, 4;
