import synch

pool = []
next = 0
lock = synch.Lock()

def malloc(v):
    atomic:
        pool[next] = v
        result = ?pool[next]
        next += 1

def free(r):
    del !r
