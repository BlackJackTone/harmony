# correct mutual exclusion using ordinary locks

import synch;

def p():
    while choose({ False, True }):
        call lock&(mylock);
        @cs: assert atLabel.cs == dict{ nametag(): 1 };
        call unlock&(mylock);
    ;
;
mylock = Lock();
atomic:
    spawn p(), 0;
    spawn p(), 0;
    spawn p(), 1;
    spawn p(), 1;
;
