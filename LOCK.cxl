routine p:
    while True:
        lock mylock;
        $cs: // critical section
        mylock := False;
    end while
end routine

mylock := False;
spawn p, 0;
spawn p, 1;
spawn p, 2;
spawn p, 3;
