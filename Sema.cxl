# correct mutual exclusion using a binary semaphore

import synch;

def p():
    while True:
        call P&(mysema);
        @cs: atomic: pass;;   # critical section
        call V&(mysema);
    ;
;
mysema = Semaphore(1);
atomic:
    spawn p(), 0;
    spawn p(), 0;
    spawn p(), 1;
    spawn p(), 1;
;
